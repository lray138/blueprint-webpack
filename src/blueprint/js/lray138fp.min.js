!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.lray138fp=r():t.lray138fp=r()}(globalThis,(()=>(()=>{"use strict";var t={d:(r,e)=>{for(var n in e)t.o(e,n)&&!t.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};t.r(r),t.d(r,{Boo:()=>n,Dom:()=>Dom,Either:()=>u,Err:()=>p,Just:()=>m,Kvm:()=>d,Left:()=>a,Lst:()=>c,Maybe:()=>y,Nil:()=>f,Nothing:()=>b,Num:()=>i,Ok:()=>h,Reader:()=>g,Result:()=>l,Right:()=>s,Str:()=>o,Task:()=>w,Writer:()=>A,addEventListener:()=>k,getElementById:()=>v,querySelector:()=>E,querySelectorAll:()=>j,querySelectorWithin:()=>querySelectorWithin});class e{constructor(){if(new.target===e)throw new Error("Gonad is an abstract class and cannot be instantiated directly.")}map(t){throw new Error("'map' function must be implemented by subtype")}bind(t){throw new Error("'bind' must be implemented by subtype.")}chain(t){return this.bind(t)}flatMap(t){return this.bind(t)}extract(){throw new Error("'extract' must be implemented by subtype.")}join(){return this.extract()}get(){return this.extract()}getOrElse(t){let r=this.extract();return null==r?t:r}goe(t){return this.getOrElse(t)}eqg(t){return this.eq(t).get()}fork(t,r){throw new Error("'fork' function must be implemented by subtype")}bimap(t,r){return this.fork(t,r)}either(t,r){return this.fork(t,r)}static unit(t){throw new Error("unit must be implemented by subtype")}static of(t){return this.unit(t)}static pure(t){return this.unit(t)}extend(t){throw new Error("'extend' must be implemented by subtype.")}ap(t){throw new Error("'ap' must be implemented by subtype.")}type(){return this.constructor.name}getType(){return this.type()}}class Boo extends e{map(t){return new Boo(t(this.extract()))}bind(t){return t(this.extract())}extend(t){return t(this)}extract(){return this.value}eq(t){return this.map((r=>r==t))}not(){return new Boo(!this.extract())}fork(t,r){let e=this.extract();return e?r(e):t(e)}isTrue(){return!0===this.extract()}isFalse(){return!this.isTrue()}dump(){return console.log(this.extract()),this}constructor(t){super(),null==t&&(t=!1),this.value=t}}function n(t){return new Boo(t)}n.of=n;class Num extends e{static unit(t){return new Num(Number(t))}add(t){return this.map((r=>r+t))}sub(t){return this.map((r=>r-t))}mul(t){return this.map((r=>r*t))}div(t){return this.map((r=>r/t))}eq(t){return this.bind((r=>n(r===t)))}map(t){return new Num(t(this.extract()))}bind(t){return this.map(t).join()}extract(){return this.value}constructor(t){super(),this.value=t}}function i(t){return Num.of(t)}i.of=i;class Either extends e{extract(){return this.value}constructor(){if(super(),new.target===Either)throw new Error("Either is an abstract class and cannot be instantiated directly.")}dump(){return console.log(this.extract()),this}}class Left extends Either{map(){return this}bind(){return this}getOrElse(t){return t}prop(t){return this}static unit(t){return new Left(t)}extract(){return this.value}fork(t,r){return t(this.extract())}ap(t){return this}tap(t){return this}extend(t){return this}eq(t){return!1}constructor(t){super(),this.value=t}}class Right extends Either{map(t){return Right.unit(t(this.extract()))}prop(t){let r=this.extract();return r&&("object"==typeof r||Array.isArray(r))&&t in r?Right.unit(r[t]):Left.unit('prop "'+t+'" not found')}call(t,...r){return this.prop(t).bind((e=>"function"==typeof e?Array.isArray(r[0])?x(e(...r[0])):x(e(...r)):Left.of('prop "'+t+'" is not callable')))}bind(t){return t(this.extract())}ap(t){return t.map(this.extract())}fork(t,r){return r(this.extract())}tap(t){return t(this.extract()),this}extend(t){return t(this)}static unit(t){return new Right(t)}extract(){return this.value}constructor(t){super(),this.value=t}}function u(t,r){return null==r&&(r=""),null==t?a(r):s(t)}function s(t){return new Right(t)}function a(t){return new Left(t)}class Str extends e{charAt(t){let r=this.extract().charAt(t);return 0==r?a("no character found at index "+t):Str.unit(r)}append(t){return new Str(this.extract()+t)}prepend(t){return new Str(t+this.extract())}static unit(t){return new Str(String(t))}map(t){return new Str(t(this.extract()))}bind(t){return this.map(t).join()}extract(){return this.value}eq(t){return this.bind((r=>n(r===t)))}toString(){return this.extract()}[Symbol.toPrimitive](){return this.extract()}constructor(t){super(),this.value=t}dump(){return console.log(this.extract()),this}}function o(t){return Str.of(t)}o.of=o;class Lst extends e{static unit(t){return new this(t)}head(){const[t]=this.extract();return void 0!==t?x(t):a("array contains no elements")}walk(t){let r=this.extract();return r.forEach(((e,n)=>t(e,n,r))),this}map(t){let r=this.extract().map(t);return new Lst(r)}filter(t){let r=this.extract(),e=r.filter(((e,n)=>t(e,n,r)));return new Lst(e)}prop(t){let r=this.extract();return r&&("object"==typeof r||Array.isArray(r))&&t in r?x(r[t]):a('prop "'+t+'" not found')}call(t,...r){return this.prop(t).bind((e=>"function"==typeof e?Array.isArray(r[0])?x(e(...r[0])):x(e(...r)):a('prop "'+t+'" is not callable')))}ap(t){return this.map((r=>r(t.extract())))}bind(t){let r=this.extract(),e=[];return r.forEach(((r,n)=>e[n]=t(r).join())),new Lst(e)}extract(){return this.value}join(t){return t=null==t?"":t,o(this.extract().join(t))}fork(t,r){return r(this.extract())}extend(t){return t(this)}constructor(t){super(),void 0===t&&(t=[]),"object"==typeof t&&Array.isArray(t)||(t=[t]),this.value=t}}function c(t){return Lst.of(t)}c.of=c;class Result extends e{extract(){return this.value}constructor(){if(super(),new.target===Result)throw new Error("Result is an abstract class and cannot be instantiated directly.")}dump(){return console.log(this.extract()),this}}class Ok extends Result{map(t){return Ok.unit(t(this.extract()))}bind(t){return t(this.extract())}ap(t){return t.map(this.extract())}fork(t,r){return r(this.extract())}tap(t){return t(this.extract()),this}extend(t){return t(this)}static unit(t){return new Ok(t)}constructor(t){super(),this.value=t}}class Err extends Result{map(){return this}bind(){return this}getOrElse(t){return t}fork(t,r){return t(this.extract())}ap(){return this}tap(){return this}extend(){return this}static unit(t){return new Err(t)}constructor(t){super(),this.value=t}}function l(t,r){return null==r&&(r=""),null==t?p(r):h(t)}function h(t){return new Ok(t)}function p(t){return new Err(t)}class Nil extends e{map(){return this}bind(){return this}ap(){return this}extend(){return this}prop(){return this}path(){return this}call(){return this}fork(t,r){return t(this.reason())}reason(){return""}isNil(){return!0}toMaybe(){return b()}toResult(){return p(this.reason())}extract(){return null}toString(){return this.reason()}[Symbol.toPrimitive](){return this.reason()}static unit(t){return new Nil}constructor(){super()}}function f(t){return Nil.of(t)}f.of=f;class Kvm extends e{static unit(t){return new this(t)}walk(t){let r=this.extract();return Object.entries(r).forEach((([e,n])=>t(n,e,r))),this}map(t){let r=this.extract(),e=Object.fromEntries(Object.entries(r).map((([r,e])=>[r,t(e)])));return new Kvm(e)}getKeys(){return x(Object.keys(this.extract()))}keys(){return this.getKeys()}filter(t){let r=this.extract(),e=Object.fromEntries(Object.entries(r).filter((([e,n])=>t(n,e,r))));return new Kvm(e)}filterKeys(t){return this.filter(((r,e,n)=>t(e,r,n)))}reduce(t,r){let e=this.extract();const n=Object.entries(e);if("function"!=typeof t)return f("reduce requires a callback");if(arguments.length>1){const i=n.reduce(((r,[n,i])=>t(r,i,n,e)),r);return x(i)}if(0===n.length)return f("cannot reduce empty Kvm without initial value");let[i,u]=n[0],s=u;for(let r=1;r<n.length;r++){const[i,u]=n[r];s=t(s,u,i,e)}return x(s)}prop(t){let r=this.extract();return"string"==typeof t&&(t.includes("/")||t.includes(".")||t.includes("["))?this.path(t):r&&"object"==typeof r&&t in r?x(r[t]):f('prop "'+t+'" not found')}path(t){if("string"!=typeof t||""===t.trim())return f('path "'+t+'" not found');const r=t.trim().split(/[/.]+/).filter((t=>""!==t)).flatMap((t=>{const r=[],e=/([^[\]]+)|\[(\d+)\]/g;let n;for(;null!==(n=e.exec(t));)r.push(n[1]??n[2]);return r}));let e=this.extract();for(const n of r){if(null==e||!(n in e))return f('path "'+t+'" not found');e=e[n]}return x(e)}tryPath(t){const r=this.path(t);return"Nil"===r.type()?p('path "'+t+'" not found'):h(r)}tryProp(t){return this.tryPath(t)}call(t,...r){return this.prop(t).bind((e=>"function"==typeof e?Array.isArray(r[0])?x(e(...r[0])):x(e(...r)):f('prop "'+t+'" is not callable')))}ap(t){return this.map((r=>r(t.extract())))}bind(t){let r=this.extract(),e={};return Object.entries(r).forEach((([r,n])=>{e[r]=t(n).extract()})),new Kvm(e)}extract(){return this.value}join(t){return t=null==t?"":t,o(Object.values(this.extract()).join(t))}fork(t,r){return r(this.extract())}extend(t){return t(this)}constructor(t){super(),null==t&&(t={}),Array.isArray(t)&&(t=Object.fromEntries(t.map(((t,r)=>[r,t])))),"object"!=typeof t&&(t={value:t}),this.value=t}}function d(t){return Kvm.of(t)}function x(t){if(t instanceof e)return t;switch(typeof t){case"boolean":return n(t);case"number":return i(t);case"string":return o(t);case"object":return Array.isArray(t)?c(t):d(t)}return t}d.of=d;class Maybe extends e{extract(){return this.value}constructor(){if(super(),new.target===Maybe)throw new Error("Maybe is an abstract class and cannot be instantiated directly.")}dump(){return console.log(this.extract()),this}}class Nothing extends Maybe{constructor(){super()}map(){return this}bind(){return this}ap(){return this}fork(t,r){return t()}extract(){return null}extend(){return this}static unit(){return new Nothing}}class Just extends Maybe{constructor(t){super(),this.value=t}prop(t){let r=this.extract();return r&&("object"==typeof r||Array.isArray(r))&&t in r?Just.unit(r[t]):Nothing.unit()}call(t,...r){return this.prop(t).bind((t=>"function"==typeof t?Array.isArray(r[0])?wrapType(t(...r[0])):wrapType(t(...r)):Nothing.of()))}map(t){return Just.of(t(this.extract()))}bind(t){return t(this.extract())}ap(t){return t.map(this.extract())}fork(t,r){return r(this.extract())}extend(t){return t(this)}static unit(t){return new Just(t)}}function y(t){return null==t?b():m(t)}function m(t){return new Just(t)}function b(){return new Nothing}class Task extends e{constructor(t){super(),this.computation=this.normalize(t)}normalize(t){return"function"!=typeof t?(r,e)=>e(t):t.length>=2?t:(r,e)=>{try{const n=t();n&&"function"==typeof n.then?n.then(e).catch(r):e(n)}catch(t){r(t)}}}static unit(t){return new Task(((r,e)=>e(t)))}map(t){return new Task(((r,e)=>{this.fork(r,(r=>e(t(r))))}))}bind(t){return new Task(((r,e)=>{this.fork(r,(n=>t(n).fork(r,e)))}))}extract(){return this.computation}fork(t,r){return this.extract()(t,r)}ap(t){return new Task(((r,e)=>{this.fork(r,(n=>{t.fork(r,(t=>{e(n(t))}))}))}))}}function w(t){return new Task(t)}w.unit=Task.unit.bind(Task),w.of=Task.of.bind(Task);class Reader extends e{constructor(t){super(),this.action=t}static unit(t){return new Reader(t)}static of(t){return this.unit(value)}static pure(t){return this.unit(value)}map(t){return new Reader((r=>t(this.run(r))))}bind(t){return new Reader((r=>t(this.run(r)).run(r)))}ask(){return new Reader((t=>t))}local(t){return new Reader((r=>this.run(t(r))))}run(t){return this.action(t)}extend(t){return t(this)}dump(t){return console.log(this.run(t)),this}}function g(t){return Reader.unit(t)}class Dom{static getElementById(t){let r=document.getElementById(t);return null==r?a(`no element with id ${t} found`):s(r)}static querySelector(t){return Dom.querySelectorWithin(t,document)}static querySelectorWithin(t,r){let e=r.querySelector(t);return null==e?a(`no element with selector ${t} found`):s(e)}static querySelectorAll(t){let r=document.querySelectorAll(t);return 0==r.length?a(`no elements with selector ${t} found`):c(Array.from(r))}static addEventListener(t,r,e){try{e.addEventListener(t,r)}catch(t){return a("problem attaching event listener")}}}function v(t){return Dom.getElementById(t)}function E(t){return Dom.querySelector(t)}function querySelectorWithin(t,r){return Dom.querySelectorWithin(t,r)}function j(t){return Dom.querySelectorAll(t)}const k=function(t){const r=t.length;return function e(...n){return n.length>=r?t.apply(this,n):function(...t){return e.apply(this,n.concat(t))}}}(((t,r,e)=>Dom.addEventListener(t,r,e)));class Writer extends e{constructor(t,r=[]){super(),this.value=t,this.log=Array.isArray(r)?r:[r]}static unit(t,r){return new Writer(t,r)}static of(t,r){return this.unit(t,r)}static pure(t,r){return this.unit(t,r)}map(t){return new Writer(t(this.value),this.log)}bind(t){const r=t(this.value);return new Writer(r.value,[...this.log,...r.log])}tell(t){return new Writer(this.value,[...this.log,t])}extract(){return{value:this.value,log:this.log}}extend(t){return t(this)}fork(t,r){return r(this.extract())}dump(){return console.log(this.extract()),this}}function A(t,r){return Writer.of(t,r)}return r})()));